<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reminders</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-slate-900">Reminders</h1>
            <a href="/overview" class="text-blue-600 hover:underline">Back to Dashboard</a>
        </header>

        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <% if(reminders.length === 0) { %>
                <div class="p-8 text-center text-slate-500">No active reminders set.</div>
            <% } else { %>
                <table class="w-full text-left">
                    <thead class="bg-slate-50 border-b border-gray-100 text-slate-500 text-sm uppercase">
                        <tr>
                            <th class="p-4 font-semibold">Status</th>
                            <th class="p-4 font-semibold">Task / Document</th>
                            <th class="p-4 font-semibold">Due Date</th>
                            <th class="p-4 font-semibold">Action</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        <% reminders.forEach(doc => { 
                            const today = new Date();
                            const due = new Date(doc.reminderDate);
                            const diffTime = due - today;
                            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                            const isUrgent = diffDays <= 10 && diffDays >= 0;
                        %>
                        <tr class="hover:bg-slate-50 transition">
                            <td class="p-4">
                                <% if(isUrgent) { %>
                                    <span class="px-3 py-1 bg-red-100 text-red-600 rounded-full text-xs font-bold animate-pulse">
                                        Due in <%= diffDays %> days
                                    </span>
                                <% } else if (diffDays < 0) { %>
                                    <span class="px-3 py-1 bg-gray-100 text-gray-500 rounded-full text-xs font-bold">Overdue</span>
                                <% } else { %>
                                    <span class="px-3 py-1 bg-green-100 text-green-600 rounded-full text-xs font-bold">On Track</span>
                                <% } %>
                            </td>
                            <td class="p-4">
                                <div class="font-bold text-slate-900"><%= doc.reminderNote %></div>
                                <div class="text-xs text-slate-400">Linked to: <%= doc.title %></div>
                            </td>
                            <td class="p-4 text-slate-600 font-medium">
                                <%= due.toLocaleDateString() %>
                            </td>
                            <td class="p-4">
                                <a href="/view-document/<%= doc._id %>" target="_blank" class="text-blue-600 hover:underline text-sm">View Doc</a>
                            </td>
                        </tr>
                        <% }) %>
                    </tbody>
                </table>
            <% } %>
        </div>
    </div>
</body>
</html>
